import{_ as i,c as s,o as e,ae as t}from"./chunks/framework.DUP9kEI5.js";const k=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"en/guide/video-to-chatml.md","filePath":"en/guide/video-to-chatml.md"}'),n={name:"en/guide/video-to-chatml.md"};function l(o,a,r,h,d,p){return e(),s("div",null,a[0]||(a[0]=[t(`<h2 id="video-to-chatml-conversion" tabindex="-1">Video-to-ChatML Conversion <a class="header-anchor" href="#video-to-chatml-conversion" aria-label="Permalink to &quot;Video-to-ChatML Conversion&quot;">​</a></h2><blockquote><p>Convert video files with dual audio tracks into ChatML format training data Perfect for extracting chat data from recorded conversation videos</p></blockquote><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Video-to-ChatML is a powerful tool that converts video files containing dual-track conversations into ChatML format training data. This feature is particularly useful for:</p><ul><li>Extracting chat data from recorded conversation videos</li><li>Converting voice conversations to text format</li><li>Generating ChatML format data for model fine-tuning</li><li>Supporting multi-language speech recognition</li></ul><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><h3 id="system-requirements" tabindex="-1">System Requirements <a class="header-anchor" href="#system-requirements" aria-label="Permalink to &quot;System Requirements&quot;">​</a></h3><ul><li>Python 3.7+</li><li>FFmpeg (for audio processing)</li><li>CUDA (optional, for GPU acceleration)</li></ul><h3 id="dependency-installation" tabindex="-1">Dependency Installation <a class="header-anchor" href="#dependency-installation" aria-label="Permalink to &quot;Dependency Installation&quot;">​</a></h3><p>Navigate to the <code>video-to-chatml</code> directory:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml</span></span></code></pre></div><p>Install Python dependencies:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span></code></pre></div><h3 id="ffmpeg-installation" tabindex="-1">FFmpeg Installation <a class="header-anchor" href="#ffmpeg-installation" aria-label="Permalink to &quot;FFmpeg Installation&quot;">​</a></h3><p><strong>Windows:</strong></p><ol><li>Download FFmpeg: <a href="https://ffmpeg.org/download.html" target="_blank" rel="noreferrer">https://ffmpeg.org/download.html</a></li><li>Extract to any directory</li><li>Add FFmpeg&#39;s bin directory to system PATH</li></ol><p><strong>Linux/Mac:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ubuntu/Debian</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS (using Homebrew)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span></code></pre></div><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="method-1-using-startup-script-recommended" tabindex="-1">Method 1: Using Startup Script (Recommended) <a class="header-anchor" href="#method-1-using-startup-script-recommended" aria-label="Permalink to &quot;Method 1: Using Startup Script (Recommended)&quot;">​</a></h3><p>Run the startup script, which will automatically check dependencies and guide you through configuration:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start-vtc.py</span></span></code></pre></div><p>The startup script will:</p><ol><li>Automatically check all dependencies</li><li>Provide an interactive configuration interface</li><li>Auto-detect video track information</li><li>Guide you to select correct track configuration</li></ol><h3 id="method-2-direct-script-usage" tabindex="-1">Method 2: Direct Script Usage <a class="header-anchor" href="#method-2-direct-script-usage" aria-label="Permalink to &quot;Method 2: Direct Script Usage&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [options] video_file_path</span></span></code></pre></div><h4 id="basic-parameters" tabindex="-1">Basic Parameters <a class="header-anchor" href="#basic-parameters" aria-label="Permalink to &quot;Basic Parameters&quot;">​</a></h4><ul><li><code>video_path</code>: Input video file path</li><li><code>--user-track</code>: User audio track index (default: 0)</li><li><code>--assistant-track</code>: Assistant audio track index (default: 1)</li><li><code>--output</code>: Output ChatML file path (default: output.jsonl)</li><li><code>--model</code>: Whisper model name (default: base)</li><li><code>--language</code>: Specify language (optional, e.g.: zh, en)</li></ul><h4 id="usage-examples" tabindex="-1">Usage Examples <a class="header-anchor" href="#usage-examples" aria-label="Permalink to &quot;Usage Examples&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic usage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conversation.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Specify tracks and output file</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conversation.mp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --user-track</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --assistant-track</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chat_data.jsonl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use larger Whisper model for better accuracy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conversation.mp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> large</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --language</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> en</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Complete parameter example</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conversation.mp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --user-track</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --assistant-track</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training_data.jsonl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> medium</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --language</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> en</span></span></code></pre></div><h2 id="whisper-model-selection" tabindex="-1">Whisper Model Selection <a class="header-anchor" href="#whisper-model-selection" aria-label="Permalink to &quot;Whisper Model Selection&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Model</th><th>Parameters</th><th>English Accuracy</th><th>Multilingual Accuracy</th><th>Speed</th><th>VRAM Required</th></tr></thead><tbody><tr><td>tiny</td><td>39M</td><td>Lower</td><td>Lower</td><td>Fastest</td><td>~1GB</td></tr><tr><td>base</td><td>74M</td><td>Medium</td><td>Medium</td><td>Fast</td><td>~1GB</td></tr><tr><td>small</td><td>244M</td><td>Good</td><td>Good</td><td>Medium</td><td>~2GB</td></tr><tr><td>medium</td><td>769M</td><td>Very Good</td><td>Very Good</td><td>Slower</td><td>~5GB</td></tr><tr><td>large</td><td>1550M</td><td>Best</td><td>Best</td><td>Slowest</td><td>~10GB</td></tr></tbody></table><p><strong>Recommendations:</strong></p><ul><li>Quick testing: <code>base</code></li><li>Balanced performance: <code>small</code> or <code>medium</code></li><li>Highest quality: <code>large</code></li></ul><h2 id="video-format-requirements" tabindex="-1">Video Format Requirements <a class="header-anchor" href="#video-format-requirements" aria-label="Permalink to &quot;Video Format Requirements&quot;">​</a></h2><h3 id="audio-track-configuration" tabindex="-1">Audio Track Configuration <a class="header-anchor" href="#audio-track-configuration" aria-label="Permalink to &quot;Audio Track Configuration&quot;">​</a></h3><p>Video files need to contain <strong>two separate audio tracks</strong>:</p><ul><li>Track 0: User voice</li><li>Track 1: Assistant voice</li></ul><h3 id="supported-video-formats" tabindex="-1">Supported Video Formats <a class="header-anchor" href="#supported-video-formats" aria-label="Permalink to &quot;Supported Video Formats&quot;">​</a></h3><ul><li>MP4 (recommended)</li><li>AVI</li><li>MOV</li><li>MKV</li><li>Other FFmpeg-supported formats</li></ul><h3 id="audio-requirements" tabindex="-1">Audio Requirements <a class="header-anchor" href="#audio-requirements" aria-label="Permalink to &quot;Audio Requirements&quot;">​</a></h3><ul><li>Sample rate: 16kHz or higher recommended</li><li>Channels: Mono or stereo</li><li>Encoding: Any FFmpeg-supported audio codec</li></ul><h2 id="output-format" tabindex="-1">Output Format <a class="header-anchor" href="#output-format" aria-label="Permalink to &quot;Output Format&quot;">​</a></h2><p>Converted data will be saved as ChatML format JSONL file, with each line containing one conversation:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;messages&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;role&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello, how&#39;s the weather today?&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;role&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;assistant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;The weather is great today, sunny and pleasant temperature.&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="advanced-configuration" tabindex="-1">Advanced Configuration <a class="header-anchor" href="#advanced-configuration" aria-label="Permalink to &quot;Advanced Configuration&quot;">​</a></h2><h3 id="language-settings" tabindex="-1">Language Settings <a class="header-anchor" href="#language-settings" aria-label="Permalink to &quot;Language Settings&quot;">​</a></h3><p>Supported language codes (partial list):</p><ul><li><code>zh</code>: Chinese</li><li><code>en</code>: English</li><li><code>ja</code>: Japanese</li><li><code>ko</code>: Korean</li><li><code>fr</code>: French</li><li><code>de</code>: German</li><li><code>es</code>: Spanish</li></ul><h3 id="performance-optimization" tabindex="-1">Performance Optimization <a class="header-anchor" href="#performance-optimization" aria-label="Permalink to &quot;Performance Optimization&quot;">​</a></h3><ol><li><strong>GPU Acceleration</strong>: Ensure CUDA version of PyTorch is installed</li><li><strong>Model Selection</strong>: Choose appropriate Whisper model based on hardware</li><li><strong>Batch Processing</strong>: Write scripts for processing multiple video files</li></ol><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="common-issues" tabindex="-1">Common Issues <a class="header-anchor" href="#common-issues" aria-label="Permalink to &quot;Common Issues&quot;">​</a></h3><p><strong>1. FFmpeg Not Found</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Error: ffmpeg not found, please install ffmpeg</span></span></code></pre></div><p>Solution: Ensure FFmpeg is properly installed and added to system PATH</p><p><strong>2. Audio Track Extraction Failed</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Error: Audio track extraction failed</span></span></code></pre></div><p>Solution:</p><ul><li>Check if video file contains specified audio tracks</li><li>Use <code>ffprobe</code> command to view video track information:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ffprobe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> quiet</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -print_format</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> json</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -show_streams</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> input.mp4</span></span></code></pre></div></li></ul><p><strong>3. Out of Memory</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Error: CUDA out of memory</span></span></code></pre></div><p>Solution:</p><ul><li>Use smaller Whisper model (like <code>base</code> or <code>small</code>)</li><li>Run on CPU (slower but doesn&#39;t require VRAM)</li></ul><p><strong>4. Low Recognition Accuracy</strong> Solution:</p><ul><li>Use larger Whisper model</li><li>Ensure good audio quality</li><li>Specify correct language parameter</li></ul><h3 id="debug-mode" tabindex="-1">Debug Mode <a class="header-anchor" href="#debug-mode" aria-label="Permalink to &quot;Debug Mode&quot;">​</a></h3><p>For detailed error information:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> video-to-chatml.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> conversation.mp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --verbose</span></span></code></pre></div><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><ol><li><strong>Audio Quality</strong>: Ensure clear recorded audio with minimal background noise</li><li><strong>Track Separation</strong>: Ensure user and assistant voices are on different tracks during recording</li><li><strong>Language Consistency</strong>: Specify correct language parameter for better recognition</li><li><strong>Model Selection</strong>: Choose appropriate Whisper model based on hardware and quality requirements</li><li><strong>Data Validation</strong>: Check output data quality and format after conversion</li></ol><h2 id="integration-with-other-features" tabindex="-1">Integration with Other Features <a class="header-anchor" href="#integration-with-other-features" aria-label="Permalink to &quot;Integration with Other Features&quot;">​</a></h2><p>The converted ChatML data can be directly used for:</p><ol><li><strong>Data Mixing</strong>: Mix with other data sources → <a href="./mix-data.html">Mix Data</a></li><li><strong>Model Fine-tuning</strong>: Use for fine-tuning large language models → <a href="./fine-tune-model.html">Fine-tune Model</a></li><li><strong>Data Cleaning</strong>: Further clean and optimize → <a href="./clean-data.html">Clean Data</a></li></ol><hr><p><strong>Tip</strong>: The Video-to-ChatML feature provides the digital avatar project with the ability to obtain training data from multimedia content, allowing you to use more diverse data sources to train personalized AI models.</p>`,76)]))}const u=i(n,[["render",l]]);export{k as __pageData,u as default};
